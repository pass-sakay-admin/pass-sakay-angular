<div class="passenger-page container">
  <div class="row pt-4">
    <div class="passenger-page-title col col-12">
      <div class="d-flex flex-row justify-content-between align-items-center">
        <h1 class="m-0 p-0">Contact Tracing</h1>
        <!-- <button class="m-0 p-0" mat-fab color="warn" (click)="save()" aria-label="Edit Profile">
          <mat-icon>save_alt</mat-icon>
        </button> -->
      </div>
    </div>
  </div>
  <div class="row pt-5">
    <mat-stepper headerPosition="top" labelPosition="bottom" #stepper>
      <mat-step [stepControl]="contactTracingForm" [optional]="false">
        <ng-template matStepLabel>Add New Positive Case</ng-template>
        <div class="row">
          <div
            class="passenger-profile-form col col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6"
            [formGroup]="contactTracingForm"
          >
            <div class="row">
              <div class="col col-12">
                <p>
                  *Note: Please be careful with tagging someone as Covid
                  Positive as it may cause an issue.
                </p>
              </div>
              <div class="col col-12">
                <mat-form-field appearance="outline" class="d-block">
                  <mat-label>Passenger</mat-label>
                  <mat-select
                    formControlName="passengerAccount"
                    placeholder="Select a Passenger"
                  >
                    <mat-option
                      aria-selected="true"
                      selected
                      *ngFor="let passenger of passengerList"
                      [value]="passenger.value"
                      >{{ passenger.text }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col col-12">
                <mat-form-field appearance="outline" class="d-block">
                  <mat-label>Status</mat-label>
                  <mat-select
                    formControlName="status"
                    placeholder="Select a status"
                  >
                    <mat-option
                      aria-selected="true"
                      selected
                      *ngFor="let status of statusList"
                      [value]="status.value"
                      >{{ status.text }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col col-12">
                <mat-form-field appearance="outline" class="d-block">
                  <mat-label>Date tagged as positive</mat-label>
                  <input
                    matInput
                    formControlName="dateTaggedAsPositive"
                    [matDatepicker]="positiveDatePicker"
                    placeholder="MM/DD/YYYY"
                    name="positiveDate"
                    (focus)="positiveDatePicker.open()"
                  />
                  <mat-datepicker-toggle
                    matSuffix
                    [for]="positiveDatePicker"
                  ></mat-datepicker-toggle>
                  <mat-datepicker #positiveDatePicker></mat-datepicker>
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
            <div class="d-flex flex-row justify-content-end gap-3">
              <button
                class="order-2"
                mat-flat-button
                color="primary"
                (click)="onTraceCloseContacts()"
                [disabled]="isFormIncomplete"
                matStepperNext
              >
                Trace close contacts
              </button>
            </div>
          </div>
        </div>
      </mat-step>
      <mat-step [optional]="false">
        <ng-template matStepLabel>Collect Travel History</ng-template>
        <div class="row">
          <div class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
            <p>
              *Note: The system collects trip history of the positive passenger 5-days before the date it was tagged as positive.
            </p>
            <div class="d-flex flex-row gap-3 pb-5">
              <button
                class=""
                mat-flat-button
                color="primary"
                (click)="checkTripHistory()"
              >
                Retrieve trip history
              </button>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
            <div class="d-flex flex-row justify-content-end gap-3">
              <button
                class="order-2"
                mat-stroked-button
                color="primary"
                matStepperPrevious
              >
                Back
              </button>
              <button
                class="order-2"
                mat-flat-button
                color="primary"
                (click)="onTraceCloseContacts()"
                [disabled]="isFormIncomplete"
                matStepperNext
              >
                Next
              </button>
            </div>
          </div>
        </div>
      </mat-step>
      <mat-step [optional]="false">
        <ng-template matStepLabel>Done</ng-template>
        You are now done.
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button (click)="stepper.reset()">Reset</button>
        </div>
      </mat-step>
    </mat-stepper>
  </div>
</div>
